#include <ESP8266WiFi.h>
#include <ESP8266HTTPClient.h>

const char* ssid = "SUA_REDE_WIFI";
const char* password = "SUA_SENHA_WIFI";

const char* serverUrl =
"https://script.google.com/macros/s/SEU_SCRIPT_ID/exec";

void setup() {
  Serial.begin(9600);

  WiFi.begin(ssid, password);
  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
  }
}

void loop() {
  if (Serial.available()) {
    String dados = Serial.readStringUntil('\n');

    if (dados.startsWith("NIVEL:")) {
      int nivel = dados.substring(6).toInt();

      if (nivel > 0 && WiFi.status() == WL_CONNECTED) {
        HTTPClient http;
        String url = String(serverUrl) + "?nivel=" + String(nivel);

        http.begin(url);
        http.GET();
        http.end();
      }
    }
  }
}
